#!/usr/bin/env sh

echo "🔍 Running Expo project checks before push..."

# Type checking (fail on errors)
echo "📝 Type checking..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "❌ Type checking failed!"
  exit 1
fi

# Linting (allow warnings, fail on errors only)
echo "🔍 Linting..."
npm run lint -- --max-warnings=20
if [ $? -ne 0 ]; then
  echo "❌ Linting failed with errors!"
  exit 1
fi

# Format checking
echo "🎨 Format checking..."
npm run format:check
if [ $? -ne 0 ]; then
  echo "❌ Format checking failed!"
  exit 1
fi

# Expo doctor (allow some failures)
echo "📱 Validating Expo config..."
npx expo doctor || echo "⚠️  Expo doctor warnings detected but continuing..."

echo "✅ Pre-push checks completed!"
